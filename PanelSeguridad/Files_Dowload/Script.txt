Set fso = CreateObject("Scripting.FileSystemObject")
Set ws = CreateObject("WScript.Shell")
Archivo = "C:\Program Files\SASIF FingerPrint\Enroller\EnrollermentApp.exe"

If fso.FileExists(Archivo) Then

   anno = Year(Date)
   User = "SASGARR"
   Name_User = "GERMAN ALEJANDRO RODRIGUEZ RODRIGUEZ"
   NIT = "900154873_9 - SASIF SAS"
   TypeDocument = "1"
   Document = "79884249"
   Name_Client = "German Alejandro Rodriguez Rodriguez"
   Fingers = "PulgarIZ,IndiceIZ,MedioIZ"

   Titulo = "Autorización de Acceso"
   Mensaje = "AUTORIZACIÓN DE ACCESO A ARCHIVOS DEL EQUIPO"+ vbCrLf + vbCrLf 
   Mensaje = Mensaje + "¿Autoriza que este archivo ejecute única y exclusivamente el programa encargado de realizar el proceso de captura de su huella?"+ vbCrLf +  vbCrLf 
   Mensaje = Mensaje + "Luego de responder, este archivo se eliminará automáticamente sin importar la opción elegida."+ vbCrLf + vbCrLf 
   Mensaje = Mensaje + "© SASIF S.A.S. " & anno

   Acepta = Msgbox(Mensaje, vbYesNo+vbQuestion+vbSystemModal, Titulo)

   Set WshShell = CreateObject("WScript.Shell")

   if Acepta = vbYes then
		FolderMyDocuments = ws.SpecialFolders("MyDocuments")
		Folder = "\SASIF FingerPrint\"
		Directory = FolderMyDocuments + Folder
		If fso.FolderExists(Directory) Then
		    fso.DeleteFolder(FolderMyDocuments + "\SASIF FingerPrint")
		    Set objFolder = fso.CreateFolder(Directory)
			Directory = Directory + "Enroller\"
			If fso.FolderExists(Directory) Then
			   Directory = Directory + "Data\"
			   If fso.FolderExists(Directory) Then
			   Else
			       Set objFolder = fso.CreateFolder(Directory)
			   End If
			Else
			   Set objFolder = fso.CreateFolder(Directory)
			   Directory = Directory + "Data\"
			   If fso.FolderExists(Directory) Then
			   Else
			       Set objFolder = fso.CreateFolder(Directory)
			   End If
			End If
		Else
			Set objFolder = fso.CreateFolder(Directory)
			Directory = Directory + "Enroller\"
			If fso.FolderExists(Directory) Then
				Directory = Directory + "Data\"
			Else
			   Set objFolder = fso.CreateFolder(Directory)
			   Directory = Directory + "Data\"
			   If fso.FolderExists(Directory) Then
			   Else
			       Set objFolder = fso.CreateFolder(Directory)
			   End If
			End If
		End If

		DirectoryFile = Directory + "Datafile.fpt"
		Set File = fso.CreateTextFile(DirectoryFile, True)

		File.WriteLine("" & User)
		File.WriteLine("" & Name_User)
		File.WriteLine("" & NIT)
		File.WriteLine("" & TypeDocument)
		File.WriteLine("" & Document)
		File.WriteLine("" & Name_Client)
		File.WriteLine("" & Fingers)
		File.Close

       Set WshShell = CreateObject("WScript.Shell")
       Return = WshShell.Run("cmd /c start """" ""C:\Program Files\SASIF FingerPrint\Enroller\EnrollermentApp.exe""", 0, false)
   else
       Msgbox "Se canceló la ejecución automática.", vbOKOnly+64+vbSystemModal, "Ejecución Automática Cancelada"
   end if
   Else
       Msgbox "El programa no se encuentra instalado en el equipo."+ vbCrLf + vbCrLf + "Por favor ejecute el instalador del aplicativo necesario para ejecutar esta acción.", vbOKOnly+64+vbSystemModal, "Aplicativo no instalado"
       Dim wShell
       Set wShell = CreateObject("WScript.Shell")
       URL = "localhost:7639/Files_Dowload/EnrollerSetup.exe"
       wShell.Run URL,9
   End If

Set PV4 = CreateObject("Scripting.FileSystemObject")
PV4.deletefile Wscript.ScriptFullName

